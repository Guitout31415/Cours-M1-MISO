library(ggplot2)
setwd('C:/Users/lemai/Desktop/Cours-M1-MISO/Stats_S2/Régression_logistique/')
library(ggplot2)
install.packages('ggplot2')
library(ggplot2)
library(ggplot2)
install.packages('ggplot2')
library(ggplot2)
install.packages('RORC')
library(RORC)
install.packages('plotROC')
library(plotROC)
load('data_premature.RData') # Charger la data .RData
#########Exercice 1
# 13)
model.1 <- glm(prema$PREMATURE~prema$GEMEL, family="binomial", data=prema)
model.2 <- glm(prema$PREMATURE~prema$EFFACE, family="binomial", data=prema)
model.3 <- glm(prema$PREMATURE~prema$GEMEL+prema$EFFACE, family="binomial", data=prema)
model.3
# 14)
test_vraissemblance <- anova(model.2, model.3, test="LRT")
test_vraissemblance
# 15)
fullmodel <- glm(prema$PREMATURE~., family="binomial", data=prema)
fullmodel
# 17)
reduced <- step(fullmodel)
summary(reduced)
test_vraissemblance <- anova(fullmodel, reduced, test="LRT")
test_vraissemblance
# 18)
AIC_
# 18)
AIC_model.2 <- model.2$aic
AIC_model.3 <- model.2$aic
AIC_fullmodel <- fullmodel$aic
# 18)
AIC_model.2 <- model.2$aic
AIC_model.3 <- model.3$aic
AIC_fullmodel <- fullmodel$aic
AIC_reduced <- reduced$aic
# 19)
plot_odds<-function(x, title = NULL){
tmp<-data.frame(cbind(exp(coef(x)), exp(confint(x))))
odds<-tmp[-1,]
names(odds)<-c('OR', 'lower', 'upper')
odds$vars<-row.names(odds)
ticks<-c(seq(.1, 1, by =.1), seq(0, 10, by =1), seq(10, 100, by =10))
ggplot(odds, aes(y= OR, x = reorder(vars, OR))) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2) +
scale_y_log10(breaks=ticks, labels = ticks) +
geom_hline(yintercept = 1, linetype=2) +
coord_flip() +
labs(title = title, x = 'Variables', y = 'OR') +
theme_bw()
}
plot_odds(reduced)
?predict
S=predict(reduced, prema, type="response")
#########Exercice 2
S <- predict(reduced, prema, type="response")
S
plot(S)
setwd('C:/Users/lemai/Desktop/Cours-M1-MISO/Stats_S2/Régression_logistique/')
install.packages('ggplot2')
library(ggplot2)
install.packages('RORC')
library(RORC)
install.packages('plotROC')
library(plotROC)
load('data_premature.RData') # Charger la data .RData
#########Exercice 1
# 13)
model.1 <- glm(prema$PREMATURE~prema$GEMEL, family="binomial", data=prema)
model.2 <- glm(prema$PREMATURE~prema$EFFACE, family="binomial", data=prema)
model.3 <- glm(prema$PREMATURE~prema$GEMEL+prema$EFFACE, family="binomial", data=prema)
model.3
# 14)
test_vraissemblance <- anova(model.2, model.3, test="LRT")
test_vraissemblance
# 15)
fullmodel <- glm(prema$PREMATURE~., family="binomial", data=prema)
fullmodel
# 17)
reduced <- step(fullmodel)
summary(reduced)
test_vraissemblance <- anova(fullmodel, reduced, test="LRT")
test_vraissemblance
# 18)
AIC_model.2 <- model.2$aic
AIC_model.3 <- model.3$aic
AIC_fullmodel <- fullmodel$aic
AIC_reduced <- reduced$aic
# 19)
plot_odds<-function(x, title = NULL){
tmp<-data.frame(cbind(exp(coef(x)), exp(confint(x))))
odds<-tmp[-1,]
names(odds)<-c('OR', 'lower', 'upper')
odds$vars<-row.names(odds)
ticks<-c(seq(.1, 1, by =.1), seq(0, 10, by =1), seq(10, 100, by =10))
ggplot(odds, aes(y= OR, x = reorder(vars, OR))) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2) +
scale_y_log10(breaks=ticks, labels = ticks) +
geom_hline(yintercept = 1, linetype=2) +
coord_flip() +
labs(title = title, x = 'Variables', y = 'OR') +
theme_bw()
}
plot_odds(reduced)
#########Exercice 2
S <- predict(reduced, prema, type="response")
plot(S)
head(S)
ggplot(data = data.frame(Pred = S, Prema = prema$PREMATURE),
aes(x = Prema, y = S, color = Prema, fill = Prema)) +
geom_boxplot() +
ylab("Score prédit")
reduced$fitted.values
decision=ifelse(S>=seuil,"positif","negatif")
ta=table(real=prema$PREMATURE,decision)
ta
VP=ta[2,2] # Vrai positif
FP=ta[1,2] # Faux positif
VN=ta[1,1] # Vrai négatif
# 21)
seuil=S[length(S)]
seuil
decision=ifelse(S>=seuil,"positif","negatif")
ta=table(real=prema$PREMATURE,decision)
ta
VP=ta[2,2] # Vrai positif
FP=ta[1,2] # Faux positif
VN=ta[1,1] # Vrai négatif
FN=ta[2,1] # Faux négatif
Se=VP/(VP+FN)
Se # Sensibilité (Taux de vrais positifs)
Sp=VN/(VN+FP)
Sp # Spécificité (Taux de vrais négatifs)
1-Sp # Taux de faux positifs
